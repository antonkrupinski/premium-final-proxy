<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Dashboard</title>
<style>
  body {
    margin:0;
    font-family: Arial, sans-serif;
    background-color: #0d1b2a;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }
  #top-section {
    display: flex;
    flex: 1;
    height: calc(100vh - 150px);
  }
  #iframe-container {
    flex: 1;
    border: none;
  }
  #adminPanel {
    width: 300px;
    background:#222;
    padding:10px;
    overflow-y:auto;
  }
  #adminPanel h3 {
    margin-top:0;
  }
  input {
    width: calc(100% - 10px);
    margin-bottom: 8px;
    padding:5px;
    border-radius:4px;
    border:none;
  }
  button {
    width:100%;
    padding:8px;
    border:none;
    border-radius:4px;
    background:#3b82f6;
    color:#fff;
    cursor:pointer;
  }
  button:hover {
    background:#2563eb;
  }
  #accountsList {
    margin-top:10px;
  }
  .account-item {
    display:flex; justify-content:space-between; align-items:center;
    background:#444; padding:4px; margin-bottom:4px; border-radius:4px;
  }
</style>
</head>
<body>

<script>
  // Parse URL to check if user is admin
  const urlParams = new URLSearchParams(window.location.search);
  const isAdmin = urlParams.get('admin') === '1';

  // Load accounts from localStorage (shared)
  let accounts = JSON.parse(localStorage.getItem('accounts')) || {};

  // If admin, ensure admin account exists
  const adminEmail = 'antonkrupinski0@gmail.com';
  const adminPassword = '201309!';
  if (isAdmin && !accounts[adminEmail]) {
    accounts[adminEmail] = adminPassword;
    localStorage.setItem('accounts', JSON.stringify(accounts));
  }

  // Save accounts
  function saveAccounts() {
    localStorage.setItem('accounts', JSON.stringify(accounts));
  }

  // Build UI
  document.body.innerHTML = `
<div id="top-section">
  <iframe id="contentIframe" src="https://peninsulaeducation.baselinux.net/" style="width:100%; height:100%; border:none;"></iframe>
  ${isAdmin ? `
  <div id="adminPanel">
    <h3>Manage Accounts</h3>
    <input type="email" id="newEmail" placeholder="Email" />
    <input type="password" id="newPassword" placeholder="Password" />
    <button id="addBtn">Add Account</button>
    <div id="accountsList"></div>
  </div>
  ` : ''}
</div>
`;

  if (isAdmin) {
    // Render accounts list
    function renderAccounts() {
      const listDiv = document.getElementById('accountsList');
      listDiv.innerHTML = '';
      for (const email in accounts) {
        const div = document.createElement('div');
        div.className='account-item';
        div.innerHTML = `
          <span>${email}</span>
          <button onclick="deleteAccount('${email}')">X</button>
        `;
        listDiv.appendChild(div);
      }
    }

    window.deleteAccount = function(email) {
      delete accounts[email];
      saveAccounts();
      renderAccounts();
    };

    document.getElementById('addBtn').onclick = () => {
      const email = document.getElementById('newEmail').value.trim();
      const pass = document.getElementById('newPassword').value.trim();
      if (email && pass && !accounts[email]) {
        accounts[email] = pass;
        saveAccounts();
        renderAccounts();
        document.getElementById('newEmail').value = '';
        document.getElementById('newPassword').value = '';
      } else {
        alert('Invalid or duplicate email');
      }
    };

    renderAccounts();
  }
</script>
</body>
</html>
